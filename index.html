<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Rizz System Dashboard</title>

<style>
body {
  background: #000;
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  padding: 20px;
}
h1 { font-size: 32px; }
input, button {
  padding: 12px;
  border-radius: 12px;
  border: none;
  margin: 5px;
}
button { cursor: pointer; }
.card {
  margin: 20px 0;
}
.bar {
  height: 10px;
  background: #222;
  border-radius: 10px;
  overflow: hidden;
}
.fill {
  height: 100%;
  background: linear-gradient(90deg,#00ff9d,#00cc88);
}
.tag {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 10px;
  margin-left: 8px;
  font-size: 12px;
}
.focus { background:#00ff9d; color:#000; }
.active { background:#444; }
.warning {
  background:#ffb300;
  color:#000;
  padding:10px;
  border-radius:12px;
  margin:15px 0;
}
</style>
</head>

<body>

<h1>üî• Rizz System Dashboard</h1>

<div id="warning"></div>

<input id="nameInput" placeholder="Enter name"/>
<button onclick="addPerson()">Add / Update</button>

<div id="list"></div>

<script>
const DECAY_HOURS = 48;
const DECAY_AMOUNT = 10;
const FOCUS_LIMIT = 2;

let people = JSON.parse(localStorage.getItem("rizzData") || "[]");

function save() {
  localStorage.setItem("rizzData", JSON.stringify(people));
}

function now() {
  return Date.now();
}

function clamp(v) {
  return Math.max(0, Math.min(100, v));
}

function addPerson() {
  const name = nameInput.value.trim();
  if (!name) return show("Please enter a name");

  let p = people.find(x => x.name === name);
  if (!p) {
    people.push({
      name,
      score: 0,
      status: "active",
      focused: false,
      lastUpdate: now()
    });
  }
  nameInput.value = "";
  save();
  render();
}

function adjust(name, delta) {
  const p = people.find(x => x.name === name);
  p.score = clamp(p.score + delta);
  p.lastUpdate = now();
  save();
  render();
}

function toggleFocus(name) {
  const focused = people.filter(p => p.focused);
  const p = people.find(x => x.name === name);

  if (!p.focused && focused.length >= FOCUS_LIMIT) {
    focused[0].focused = false;
    show("Focus limit reached ‚Äî oldest focus removed");
  }

  p.focused = !p.focused;
  p.lastUpdate = now();
  save();
  render();
}

function deletePerson(name) {
  people = people.filter(p => p.name !== name);
  save();
  render();
}

function runDecay() {
  const current = now();

  people.forEach(p => {
    if (p.focused || p.status !== "active") return;

    const hoursPassed = (current - p.lastUpdate) / (1000 * 60 * 60);
    if (hoursPassed >= DECAY_HOURS) {
      p.score = clamp(p.score - DECAY_AMOUNT);
      p.lastUpdate = current;
    }
  });

  save();
  render();
}

function show(msg) {
  warning.innerHTML = `<div class="warning">${msg}</div>`;
  setTimeout(() => warning.innerHTML = "", 2500);
}

function render() {
  list.innerHTML = "";
  people.forEach(p => {
    list.innerHTML += `
      <div class="card">
        <strong>${p.name} ‚Äî ${p.score}%</strong>
        ${p.focused ? `<span class="tag focus">FOCUS</span>` : `<span class="tag active">ACTIVE</span>`}
        <div class="bar"><div class="fill" style="width:${p.score}%"></div></div>
        <button onclick="adjust('${p.name}',-10)">-10</button>
        <button onclick="adjust('${p.name}',10)">+10</button>
        <button onclick="toggleFocus('${p.name}')">Focus</button>
        <button onclick="deletePerson('${p.name}')">Delete</button>
      </div>
    `;
  });
}

// ‚è±Ô∏è SAFE decay timer (runs once)
setInterval(runDecay, 1000 * 60 * 60); // check hourly

render();
</script>

</body>
</html>
